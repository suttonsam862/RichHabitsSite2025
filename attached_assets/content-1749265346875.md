[Skip to content](https://github.com/vitejs/vite-plugin-react/issues/11#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/vitejs/vite-plugin-react/issues/11) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/vitejs/vite-plugin-react/issues/11) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/vitejs/vite-plugin-react/issues/11) to refresh your session.Dismiss alert

[vitejs](https://github.com/vitejs)/ **[vite-plugin-react](https://github.com/vitejs/vite-plugin-react)** Public

- Sponsor







# Sponsor vitejs/vite-plugin-react























##### GitHub Sponsors

[Learn more about Sponsors](https://github.com/sponsors)







[![@vitejs](https://avatars.githubusercontent.com/u/65625612?s=80&v=4)](https://github.com/vitejs)



[vitejs](https://github.com/vitejs)



[vitejs](https://github.com/vitejs)



[Sponsor](https://github.com/sponsors/vitejs)









##### External links





![open_collective](https://github.githubassets.com/assets/open_collective-0a706523753d.svg)



[opencollective.com/ **vite**](https://opencollective.com/vite)









[Learn more about funding links in repositories](https://docs.github.com/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/displaying-a-sponsor-button-in-your-repository).




[Report abuse](https://github.com/contact/report-abuse?report=vitejs%2Fvite-plugin-react+%28Repository+Funding+Links%29)

- [Notifications](https://github.com/login?return_to=%2Fvitejs%2Fvite-plugin-react) You must be signed in to change notification settings
- [Fork\\
149](https://github.com/login?return_to=%2Fvitejs%2Fvite-plugin-react)
- [Star\\
732](https://github.com/login?return_to=%2Fvitejs%2Fvite-plugin-react)


# \[plugin-react-refresh\] auto page reloading is broken when a jsx file contain multi-components\#11

[New issue](https://github.com/login?return_to=https://github.com/vitejs/vite-plugin-react/issues/11#discussion_r430879201)

Copy link

[New issue](https://github.com/login?return_to=https://github.com/vitejs/vite-plugin-react/issues/11#discussion_r430879201)

Copy link

Closed

[#79](https://github.com/vitejs/vite-plugin-react/pull/79)

Closed

[\[plugin-react-refresh\] auto page reloading is broken when a jsx file contain multi-components](https://github.com/vitejs/vite-plugin-react/issues/11#top)#11

[#79](https://github.com/vitejs/vite-plugin-react/pull/79)

Copy link

Labels

[feat: hmr](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22feat%3A%20hmr%22) [p3-minor-bug üî®An edge case that only affects very specific usage (priority)](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22p3-minor-bug%20%F0%9F%94%A8%22) An edge case that only affects very specific usage (priority)

[![@kljzndx](https://avatars.githubusercontent.com/u/23692559?u=349ba45a2f2f3945d2c26d1875a0a205327bdbc9&v=4&size=80)](https://github.com/kljzndx)

## Description

[![@kljzndx](https://avatars.githubusercontent.com/u/23692559?u=349ba45a2f2f3945d2c26d1875a0a205327bdbc9&v=4&size=48)](https://github.com/kljzndx)

[kljzndx](https://github.com/kljzndx)

opened [on Sep 13, 2021](https://github.com/vitejs/vite-plugin-react/issues/11#issue-1473867557)

Issue body actions

### Describe the bug

For details. Please view the video

[![video](https://camo.githubusercontent.com/d2ac16fc0cc4c6a80f833332e400d023d1aed90a9d7b24d26347393d642160c0/68747470733a2f2f73332e626d702e6f76682f696d67732f323032312f30392f663034393033353061323537333862362e676966)](https://camo.githubusercontent.com/d2ac16fc0cc4c6a80f833332e400d023d1aed90a9d7b24d26347393d642160c0/68747470733a2f2f73332e626d702e6f76682f696d67732f323032312f30392f663034393033353061323537333862362e676966)[![video](https://camo.githubusercontent.com/d2ac16fc0cc4c6a80f833332e400d023d1aed90a9d7b24d26347393d642160c0/68747470733a2f2f73332e626d702e6f76682f696d67732f323032312f30392f663034393033353061323537333862362e676966)](https://camo.githubusercontent.com/d2ac16fc0cc4c6a80f833332e400d023d1aed90a9d7b24d26347393d642160c0/68747470733a2f2f73332e626d702e6f76682f696d67732f323032312f30392f663034393033353061323537333862362e676966)[Open video in new window](https://camo.githubusercontent.com/d2ac16fc0cc4c6a80f833332e400d023d1aed90a9d7b24d26347393d642160c0/68747470733a2f2f73332e626d702e6f76682f696d67732f323032312f30392f663034393033353061323537333862362e676966)

### Reproduction

[https://github.com/kljzndx/Test-Demos/tree/vite-react-bug](https://github.com/kljzndx/Test-Demos/tree/vite-react-bug)

### System Info

```
System:
    OS: Linux 5.10 Debian GNU/Linux 10 (buster) 10 (buster)
    CPU: (4) arm64 unknown
    Memory: 1.52 GB / 3.71 GB
    Container: Yes
    Shell: 5.7.1 - /usr/bin/zsh
  Binaries:
    Node: 14.16.0 - /usr/local/bin/node
    Yarn: 1.22.11 - /usr/local/bin/yarn
    npm: 7.23.0 - /usr/local/bin/npm
  Browsers:
    Chromium: 89.0.4389.114 # Raspberry pi
    Edge: 93.0.961.47 # local PC
```

### Used Package Manager

yarn

### Logs

_No response_

### Validations

- Follow our [Code of Conduct](https://github.com/vitejs/vite/blob/main/CODE_OF_CONDUCT.md)































Read the [Contributing Guidelines](https://github.com/vitejs/vite/blob/main/CONTRIBUTING.md).































Read the [docs](https://vitejs.dev/guide).































Check that there isn't [already an issue](https://github.com/vitejs/vite/issues) that reports the same bug to avoid creating a duplicate.































Make sure this is a Vite issue and not a framework-specific issue. For example, if it's a Vue SFC related bug, it should likely be reported to [https://github.com/vuejs/vue-next](https://github.com/vuejs/vue-next) instead.































Check that this is a concrete bug. For Q&A open a [GitHub Discussion](https://github.com/vitejs/vite/discussions) or join our [Discord Chat Server](https://chat.vitejs.dev/).































The provided reproduction is a [minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example) of the bug.




















To pick up a draggable item, press the space bar.
While dragging, use the arrow keys to move the item.
Press space again to drop the item in its new position, or press escape to cancel.



üëç2

## Activity

[![IanVS](https://avatars.githubusercontent.com/u/4616705?u=b33501ef2cd955dd3cfbd63e4208ed02b0d6a46e&v=4&size=80)](https://github.com/IanVS)

### IanVS commented on Sep 15, 2021

[![@IanVS](https://avatars.githubusercontent.com/u/4616705?u=b33501ef2cd955dd3cfbd63e4208ed02b0d6a46e&v=4&size=48)](https://github.com/IanVS)

[IanVS](https://github.com/IanVS)

[on Sep 15, 2021](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1336121331)

React fast refresh does not work with `class` components, only functional components. There's an [issue vitejs/vite-plugin-react#8](https://github.com/vitejs/vite-plugin-react/issues/8) open to include class components.

[![kljzndx](https://avatars.githubusercontent.com/u/23692559?u=349ba45a2f2f3945d2c26d1875a0a205327bdbc9&v=4&size=80)](https://github.com/kljzndx)

### kljzndx commented on Sep 15, 2021

[![@kljzndx](https://avatars.githubusercontent.com/u/23692559?u=349ba45a2f2f3945d2c26d1875a0a205327bdbc9&v=4&size=48)](https://github.com/kljzndx)

[kljzndx](https://github.com/kljzndx)

[on Sep 15, 2021](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1336121332)

Author

Â•ΩÂêßÔºåÁúãÊù•ÊòØÊàëËØØËß£‰∫Ü„ÄÇ‰ΩÜÊòØ‰∏∫‰ªÄ‰πàÊñáÊ°£ÈáåÈù¢Âè™Â≠óÊú™ÊèêËøô‰ª∂‰∫ãÔºü

--------------Google Translate------------

Well, it seems I misunderstood. But why is it not mentioned in the document?

[![JonathanSoszka](https://avatars.githubusercontent.com/u/48253221?u=e02b87b58f7690db454e9fca46bf156052e94259&v=4&size=80)](https://github.com/JonathanSoszka)

### JonathanSoszka commented on May 11, 2022

[![@JonathanSoszka](https://avatars.githubusercontent.com/u/48253221?u=e02b87b58f7690db454e9fca46bf156052e94259&v=4&size=48)](https://github.com/JonathanSoszka)

[JonathanSoszka](https://github.com/JonathanSoszka)

[on May 11, 2022](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1336121334)

I was having the same issue using functional style components. I was able to fix this by not using `export default`

Chainging this code

```notranslate
export default function() {
  return (
    <div className={"grid"}>
      <div className={"col-12"}>
        <ProfileHeader/>
      </div>
      <div className={"col-12 lg:col-6"}>
        <ProfileInfoCard/>
      </div>
      <div className={"col-12 lg:col-6"}>
        <ProfileGamesCard/>
      </div>
    </div>
  );
}

function ProfileInfoCard() {
  return (
    <Card title={"Info"}></Card>
  )
}

function ProfileGamesCard() {
  return (
    <Card title={"Games"}></Card>
  )
}

```

To This, fixed it for me

```notranslate
export function Profile() {
  return (
    <div className={"grid"}>
      <div className={"col-12"}>
        <ProfileHeader/>
      </div>
      <div className={"col-12 lg:col-6"}>
        <ProfileInfoCard/>
      </div>
      <div className={"col-12 lg:col-6"}>
        <ProfileGamesCard/>
      </div>
    </div>
  );
}

function ProfileInfoCard() {
  return (
    <Card title={"Info"}></Card>
  )
}

function ProfileGamesCard() {
  return (
    <Card title={"Games"}></Card>
  )
}

```

[![](https://avatars.githubusercontent.com/u/49056869?s=64&u=ec70859392ec0140d60446f7815ad2bf857904fd&v=4)sapphi-red](https://github.com/sapphi-red)

mentioned this [on Oct 4, 2022](https://github.com/vitejs/vite-plugin-react/issues/11#event-1234716240)

- [fix(react): conditionally self-accept fast-refresh HMR vitejs/vite#10239](https://github.com/vitejs/vite/pull/10239)


[![](https://avatars.githubusercontent.com/u/583075?s=64&u=c2ea71ad847aecf66885e68d81a876fff1486bdd&v=4)patak-dev](https://github.com/patak-dev)

transferred this issue from [vitejs/vite](https://github.com/vitejs/vite) [on Dec 2, 2022](https://github.com/vitejs/vite-plugin-react/issues/11#event-7945880280)

[![sapphi-red](https://avatars.githubusercontent.com/u/49056869?u=ec70859392ec0140d60446f7815ad2bf857904fd&v=4&size=80)](https://github.com/sapphi-red)

### sapphi-red commented on Dec 18, 2022

[![@sapphi-red](https://avatars.githubusercontent.com/u/49056869?u=ec70859392ec0140d60446f7815ad2bf857904fd&v=4&size=48)](https://github.com/sapphi-red)

[sapphi-red](https://github.com/sapphi-red)

[on Dec 18, 2022](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1357042735)

Member

I confirmed this still does not work. (Vite 4.0.2 + plugin-react 3.0.0)

[https://stackblitz.com/edit/github-vnvsys?file=src%2FTest2%20-%20component.jsx](https://stackblitz.com/edit/github-vnvsys?file=src%2FTest2%20-%20component.jsx)

HMR not happening is expected due to the limitation of react refresh, but the full reload should happen.

üëç1

[![](https://avatars.githubusercontent.com/u/49056869?s=64&u=ec70859392ec0140d60446f7815ad2bf857904fd&v=4)sapphi-red](https://github.com/sapphi-red)

added

[feat: hmr](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22feat%3A%20hmr%22)

[p3-minor-bug üî®An edge case that only affects very specific usage (priority)](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22p3-minor-bug%20%F0%9F%94%A8%22) An edge case that only affects very specific usage (priority)

[on Dec 18, 2022](https://github.com/vitejs/vite-plugin-react/issues/11#event-8065509891)

[![Carseason](https://avatars.githubusercontent.com/u/25239238?u=faf95dfba17d48b98d609278d511ff04bdf6147c&v=4&size=80)](https://github.com/Carseason)

### Carseason commented on Jan 8, 2023

[![@Carseason](https://avatars.githubusercontent.com/u/25239238?u=faf95dfba17d48b98d609278d511ff04bdf6147c&v=4&size=48)](https://github.com/Carseason)

[Carseason](https://github.com/Carseason)

[on Jan 8, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1375261245) ¬∑ Hidden as duplicate

show comment

[![](https://avatars.githubusercontent.com/u/14235743?s=64&u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4)ArnaudBarre](https://github.com/ArnaudBarre)

mentioned this [on Jan 22, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#event-1257663783)

- [feat: invalidate message and fix HMR for HOC, class component & styled components #79](https://github.com/vitejs/vite-plugin-react/pull/79)


[![ArnaudBarre](https://avatars.githubusercontent.com/u/14235743?u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4&size=80)](https://github.com/ArnaudBarre)

### ArnaudBarre commented on Jan 22, 2023

[![@ArnaudBarre](https://avatars.githubusercontent.com/u/14235743?u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4&size=48)](https://github.com/ArnaudBarre)

[ArnaudBarre](https://github.com/ArnaudBarre)

[on Jan 22, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#issuecomment-1399627609)

Member

This issue will be fixed by [#79](https://github.com/vitejs/vite-plugin-react/pull/79). Waiting for Vite 4.1 to enable this change

üëç1

[![](https://avatars.githubusercontent.com/u/14235743?s=64&u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4)ArnaudBarre](https://github.com/ArnaudBarre)

mentioned this [on Jan 22, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#event-1257664236)

- [Expand "@vitejs/plugin-react-refresh" to allow class components and non-component exports #8](https://github.com/vitejs/vite-plugin-react/issues/8)


[![](https://avatars.githubusercontent.com/u/14235743?s=64&u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4)ArnaudBarre](https://github.com/ArnaudBarre)

closed this as [completed](https://github.com/vitejs/vite-plugin-react/issues?q=is%3Aissue%20state%3Aclosed%20archived%3Afalse%20reason%3Acompleted) in [#79](https://github.com/vitejs/vite-plugin-react/pull/79) [on Jan 25, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#event-8354993881)

[![](https://avatars.githubusercontent.com/in/15368?s=64&v=4)github-actions](https://github.com/apps/github-actions)

locked and limited conversation to collaborators [on Feb 8, 2023](https://github.com/vitejs/vite-plugin-react/issues/11#event-8474451393)

[![](https://avatars.githubusercontent.com/u/49056869?s=64&u=ec70859392ec0140d60446f7815ad2bf857904fd&v=4)sapphi-red](https://github.com/sapphi-red)

added a commit that references this issue [on Mar 30, 2025](https://github.com/vitejs/vite-plugin-react/issues/11#event-17053536658)

[fix: don't add react refresh wrapper for SSR transform (fixes #11)](https://github.com/vitejs/vite-plugin-react/commit/fd8187a022ba1b4bf2da77a3c3d027b59cb3dd31)

[fix: don't add react refresh wrapper for SSR transform (fixes #11)](https://github.com/vitejs/vite-plugin-react/commit/fd8187a022ba1b4bf2da77a3c3d027b59cb3dd31)

[fix: don't add react refresh wrapper for SSR transform (fixes](https://github.com/vitejs/vite-plugin-react/commit/fd8187a022ba1b4bf2da77a3c3d027b59cb3dd31) [#11](https://github.com/vitejs/vite-plugin-react/issues/11))

This issue will close once commit fd8187a is merged into the 'main' branch. [fd8187a](https://github.com/vitejs/vite-plugin-react/commit/fd8187a022ba1b4bf2da77a3c3d027b59cb3dd31)

[Sign up for free](https://github.com/signup?return_to=https://github.com/vitejs/vite-plugin-react/issues/11#discussion_r430879201)**to join this conversation on GitHub.** Already have an account? [Sign in to comment](https://github.com/login?return_to=https://github.com/vitejs/vite-plugin-react/issues/11#discussion_r430879201)

## Metadata

## Metadata

### Assignees

No one assigned

### Labels

[feat: hmr](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22feat%3A%20hmr%22) [p3-minor-bug üî®An edge case that only affects very specific usage (priority)](https://github.com/vitejs/vite-plugin-react/issues?q=state%3Aopen%20label%3A%22p3-minor-bug%20%F0%9F%94%A8%22) An edge case that only affects very specific usage (priority)

### Type

No type

### Projects

No projects

### Milestone

No milestone

### Relationships

None yet

### Development

Code with Copilot Agent Mode

Select code repository

- [feat: invalidate message and fix HMR for HOC, class component & styled componentsvitejs/vite-plugin-react](https://github.com/vitejs/vite-plugin-react/pull/79)

### Participants

[![@IanVS](https://avatars.githubusercontent.com/u/4616705?s=64&u=b33501ef2cd955dd3cfbd63e4208ed02b0d6a46e&v=4)](https://github.com/IanVS)[![@ArnaudBarre](https://avatars.githubusercontent.com/u/14235743?s=64&u=1e3fb343c89f3f3ab51080295026475541c390f8&v=4)](https://github.com/ArnaudBarre)[![@kljzndx](https://avatars.githubusercontent.com/u/23692559?s=64&u=349ba45a2f2f3945d2c26d1875a0a205327bdbc9&v=4)](https://github.com/kljzndx)[![@Carseason](https://avatars.githubusercontent.com/u/25239238?s=64&u=faf95dfba17d48b98d609278d511ff04bdf6147c&v=4)](https://github.com/Carseason)[![@JonathanSoszka](https://avatars.githubusercontent.com/u/48253221?s=64&u=e02b87b58f7690db454e9fca46bf156052e94259&v=4)](https://github.com/JonathanSoszka)

+1

## Issue actions

You can‚Äôt perform that action at this time.


\[plugin-react-refresh\] auto page reloading is broken when a jsx file contain multi-components ¬∑ Issue #11 ¬∑ vitejs/vite-plugin-react