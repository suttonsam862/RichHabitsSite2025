
> rest-express@1.0.0 dev
Stripe live mode: true tsx server/index.ts
WARNING: Using Stripe live mode in development environment
Consider using test mode for development to avoid real charges
Development: Serving static files from: /home/runner/workspace/public
Setting up application...
‚úÖ Vite development server ready
‚úÖ Rich Habits server running on port 5000 in development mode
üåê Server address: { address: '0.0.0.0', family: 'IPv4', port: 5000 }
=== BULLETPROOF PAYMENT REQUEST ===
Request body: {
  "option": "full",
  "registrationData": {
    "firstName": "Samuel",
    "lastName": "Sutton",
    "email": "samsutton@rich-habits.com",
    "phone": "2055869574",
    "contactName": "Samuel Sutton",
    "tShirtSize": "",
    "grade": "14th",
    "gender": "Male",
    "schoolName": "Oak Mountain High School",
    "clubName": "",
    "medicalReleaseAccepted": false,
    "day1": false,
    "day2": false,
    "day3": false,
    "eventId": 1,
    "registrationType": "full"
  },
  "discountedAmount": null,
  "discountCode": null,
  "formSessionId": "session_1749411225912_zyjqp1plp"
}
Event ID: 1
=== BULLETPROOF PAYMENT REQUEST ===
Request body: {
  "option": "full",
  "registrationData": {
    "firstName": "Samuel",
    "lastName": "Sutton",
    "email": "samsutton@rich-habits.com",
    "phone": "2055869574",
    "contactName": "Samuel Sutton",
    "tShirtSize": "",
    "grade": "14th",
    "gender": "Male",
    "schoolName": "Oak Mountain High School",
    "clubName": "",
    "medicalReleaseAccepted": false,
    "day1": false,
    "day2": false,
    "day3": false,
    "eventId": 1,
    "registrationType": "full"
  },
  "discountedAmount": null,
  "discountCode": null,
  "formSessionId": "session_1749411225914_qtf2uz9z4"
}
Event ID: 1
Using bulletproof payment service for registration...
üí∞ Using calculated base amount: $249 for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
üéØ Processing payment request - Session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv, Email: samsutton@rich-habits.com, Amount: $249, DiscountCode: null
üîí Locking session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv for samsutton@rich-habits.com - Event 1
üí≥ Creating new payment intent with idempotency key: payment_c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv_1749411226760
Using bulletproof payment service for registration...
üí∞ Using calculated base amount: $249 for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
üéØ Processing payment request - Session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv, Email: samsutton@rich-habits.com, Amount: $249, DiscountCode: null
‚ö†Ô∏è Session locked but no payment intent found: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
üîì Unlocked session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
üîí Locking session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv for samsutton@rich-habits.com - Event 1
üí≥ Creating new payment intent with idempotency key: payment_c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv_1749411226769
üí≥ Storing payment intent: pi_3RXoyVBIRPjPy7BL0dHKTAQ8 for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
‚úÖ Created payment intent: pi_3RXoyVBIRPjPy7BL0dHKTAQ8 for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
Payment service result: { success: true, amount: 249, hasClientSecret: true }
üí≥ Storing payment intent: pi_3RXoyVBIRPjPy7BL0TOV7BAa for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
‚úÖ Created payment intent: pi_3RXoyVBIRPjPy7BL0TOV7BAa for session: c2Ftc3V0dG9uQHJpY2gtaGFiaXRzLmNv
Payment service result: { success: true, amount: 249, hasClientSecret: true }
Validating discount code: 1XsWQ23OakMountain12! for amount: $249
Discount validation failed: Invalid discount code